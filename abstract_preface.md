# 摘要
自上世纪70年代以来，基于微处理器的数字平台一直在遵循摩尔定律，使得每两年左右相同面积的密度翻一番。然而，虽然微处理器制造一直专注于提高指令执行速率，但内存制造技术主要侧重于容量增加而速度提升甚少。这种处理器与内存之间性能趋势的分歧导致了“内存墙”现象的发生。

为了克服内存墙，设计者们使用了分层缓存来降低处理器与内存之间的性能差距。不幸的是，重要的工作负载类具有破坏性的内存访问模式，这使得现代缓存层次结构内置的简单策略无法移动指令和数据跨缓存层次结构。因此，当处理器需要从更高层次的缓存中获取缺失的数据块时，它经常会在空闲中花费大量时间。

预取——预测未来的内存存取并在明确访问之前发出对相应内存块的请求——是一种有效的方法来隐藏内存存取延迟。已经提出了许多预取技术，几乎每个现代处理器都包含一些针对简单且规则化的内存存取模式的硬件预取机制。本章提供了研究文献中提出的指令和数据的各种硬件预取器类别的概览，并展示了用于现代微处理器中的技术示例。

# 关键字

硬件预取、下一行预取、分支定向预取、不连续预取、步长预取、地址相关预取、马尔可夫预读器、全局历史缓冲区、时间内存流、空间内存流、执行驱动预取

# 前言

自上世纪70年代诞生以来，基于微处理器的数字平台一直遵循摩尔定律，使得每两年左右相同面积的密度翻一番。然而，微处理器和内存制造技术在某种程度上以两种截然相反的方式利用了这种增加的密度。微处理器的制造侧重于提高机器指令执行的速度，而内存制造技术则主要关注容量的增长，速度几乎没有增长。处理器和内存之间性能的这种分歧导致了一个被称为“内存墙”的现象。[1]

为了克服内存墙，设计者们使用了多级高速缓存来提高容量。 高速缓存依赖于内存访问局部性的原则，以减少观察到的内存访问时间和处理器与内存之间的性能差距。 不幸的是，有许多重要的工作负载类别表现出对现代高速缓存层次结构内置的简单策略不利的内存访问模式，这些策略用于在高速缓存级别之间移动指令和数据。 因此，当需要从较高高速缓存级别中获取缺失的内存块时，处理器通常会花费大量时间空闲等待。

本导论概述了多年来为指令和数据提出的各种硬件预取技术，并展示了融入现代微处理器的技术示例。尽管本书中介绍的技术绝不是全面的，但它们涵盖了每个类别的关键技术示例，因此对于计划熟悉该领域的人员来说，这本书是一份合适的综述。我们讨论的是指令和数据高速缓存预取，但是我们讨论的许多技术也可以应用于将内存转换为快速存储器缓冲区（参见例如[2]）。

本教程分为四章。第一章，我们介绍了内存层次结构和一般的预取概念。第二章，我们描述了预取指令的技术。第三章涵盖了预取数据技术，我们在第四章中总结了这些技术。指令预取技术包括下一行预取、分支导向预取、不连续性预取和时间性指令流。数据预读器包括步长和流数据预取程序、地址相关预取、空间相关预取尤其是基于执行的预取。

我们假设读者对处理器架构和高速缓存的基本知识已经熟悉，并且对一些更高级的话题（如乱序执行）有所了解。 本书列出了设计硬件预取器的关键问题，并提供了各种预取技术的高层次描述。 我们鼓励读者参阅所引用的出版物，以获取有关预取方案的完整微体系结构详细信息和性能评估。


我们想感谢所有为本书做出贡献的人。 感谢Mark Hill 帮助我们完成写作和编辑过程。 感谢Cansu Kaynak 和Michael Ferdman 提供了关于这本书的手稿和评论。 感谢Margaret Martonosi、Calvin Lin和其他匿名评审者，他们的反馈帮助改进了本书。
